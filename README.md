# Logchain-recon

**Logchain-recon** is a multi-step attacks log reconstruction pipeline based on machine and deep learning techniques. The framework is designed to extend [Wazuh](https://github.com/wazuh/wazuh) SIEM with AI-based functionalities. The main goal of Logchain-recon is *reconstructing attack paths* by building graphs that represent the relationships between different log events.

## File description and workflow

- *dataset_extraction.ipynb*: extract the dataset and start preprocessing.
- *dataset_preprocessing.ipynb*: dataset features analysis and cleaning.
- *proc_labels.ipynb*: labels processing and association with corresponding logs.
- *descr_vectorization.ipynb*: logs descriptions conversion into embeddings generated by using SentenceTransformer.
- *training_classifiers.py*: train logs classifiers (FFNN, XGBoost, LightGBM and CatBoost).
- *graph_builder.py*: Graph builder's implementation.
- *build_graph_dataset.py*: generate graphs from dataset logs.
- *training_edge_predictor.py*: train edge predictor model (GraphSAGE).
- *attack_seq_recon.py*: evaluate a graph by using the edge predictor, reconstruct the attack sequence from the edge predictor's output graph, summarize it and generate a report via LLM.